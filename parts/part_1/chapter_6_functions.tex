\chapter{Functions}
\label{chapter:functions}
\marginurl{%
    Functions and Quantifiers:\\\noindent
    Introduction to Mathematical Reasoning \#7
}{youtu.be/VHJeUrCedTU}

Another important type of objects in mathematics are functions. Function $f$
from a set $X$ to a set $Y$ (written as $f : X \to Y$) is a unique
assignment of elements of $Y$ to the elements of $X$ (note that it is not
necessary that all the elements of $Y$ are used). In other words, for each
element $x \in X$ there is one assigned element $f(x) \in Y$. We call such an
element the \emph{value} of $f$ at $x$, we also say that $f(x)$ is an
\emph{image} of $x$.

Unfortunately, the definition is not formal. Through this chapter we will
provide a more formal definition.

\section{Quantifiers.}
The first ingredient is called quantifiers. Very often we use phrases like ``all
the people in the class have smartphones.'' However, we still do not know how to
write it using symbols.

\paragraph{The Universal Quantifier.}
In order to say ``all'' or ``every'' we use the symbol $\forall$\footnote{%
    The symbol is a turned ``A'' symbol, the first letter of the word ``all''.
}: if $P(a)$ is a predicate about $a \in A$, then $\forall a \in A\ P(a)$ is a
statement saying that all the elements of $A$ satisfy the predicate $P$. In
other words it is the same as the statement
$\set[P(a)]{a \in A} = A$. For example, $\forall x \in \R\ x \cdot 0 = 0$ says
that product of every real number and zero is equal to zero.
\nomenclature[L]{$\forall x \in X~P(x)$}{denotes the statement saying that
$P$ is true for all elements of $X$}

\paragraph{The Existential Quantifier.}
The second quantifier means ``there is'' and is denoted by the symbol
$\exists$\footnote{%
    The symbol is a turned ``E'' symbol, the first letter of the word
    ``exists''. It is also interesting that the symbol for the universal
    quantifier was introduced by Gerhard Gentzen in 1935 but the symbol for the
    existential quantifier was introduced, 38 years earlier, by Giuseppe Peano
    in 1897.
}:
if $P(a)$ is a predicate about an element of $A$, then $\exists a \in A\ P(a)$
says that there is an element of $A$ satisfying the predicate $P$ i.e.
$\set[P(a)]{a \in A} \neq \emptyset$. For example,
$\exists x \in \R\ x^2 - 1 = 0$ states that there is a real solution of the
equation $x^2 - 1 = 0$.
\nomenclature[L]{$\exists x \in X~P(x)$}{denotes the statement saying that
$P$ is true for some element of $X$}

\begin{warning}
    Note that the word ``any'' sometimes indicates a universal statement and
    sometimes an existential statement.

    Standard meaning of ``any'' is ``every'' like in the statement ``$a^2 \ge 0$
    for any real number'', therefore this statement can be rewritten as
    $\forall a \in \R \ a^2 \ge 0$. Nonetheless, in the negative and interrogative
    statements ``any'' is used to mean ``some''. For example, ``There is not any
    real number $a$ such that $a^2 < 0$'' is asserting that the statement
    $\exists a \in \R \ a^2 < 0$ is false. And ``Is there any real number $a$ such
    that $a^2 = 1$?'' is asking whether the existential statement
    $\exists a \in \R \ a^2 = 1$ is true.

    Real care is required with questions involving ``any'': ``Is there any
    integer $a$ such that $a \ge 1$?'' clearly is asking whether $\exists a \in
    \R \ a^2 \ge 1$ is true; however, ``Is $a \ge 1$ for any integer $a$'' is less
    clear and might be taken to asking about the same question as the first
    question, $\exists a \in \Z \ a \ge 1$ (which is true) but might also be
    taken to be asking about $\forall a \in \Z \ a \ge 1$ (which is false).
\end{warning}

\subsection{Proving Statements Involving Quantifiers}
Most of the statements in mathematics involve quantifiers. This is one of the
factors distinguishing advanced from elementary mathematics. In this section we
give an overview of the main methods of proof. Though the whole book is about
proving such results.

\paragraph{Proving statements of the form $\forall a \in A \ P(a)$.}
Such statements can be rewritten in the form $a \in A \implies P(a)$. For
example, we proved earlier that $a^2 \ge 0$ for all real numbers $a$ using this
approach.

\paragraph{Proving statements of the form $\exists a \in A \ P(a)$.}
The easiest way to prove such a statement is by simply exhibiting an element $a$
of $A$ such that $P(a)$ is true. This method is called \emph{proof by
example}.

Let us prove the statement $\exists x \in \N \ x^2 = 4$ using this method.
Observe that $2 \in N$ and $2^2 = 4$ so $x = 2$ provides an example proving
this statement. There are, however, less direct methods such as use of the
counting arguments.

\paragraph{Proving statements involving both quantifiers.}
To illustrate problems of this type let us prove that for any integer $n$, if
$n$ is even, then $n^2$ is also even.

This statement is a universal statement $\forall n \in \Z \ (n \text{ is even}
\implies n^2 \text{ is even})$. However, the hypothesis that $n$ is even is an
existential statement $\exists q \in \Z \ n = 2q$. So we begin the proof as
follows:
\begin{center}
    Suppose that $n$ is an even integer. Then $n = 2q$ for some integer $q$.
\end{center}
The conclusion we wish to prove is that $n^2$ is even, which may be written as
$\exists q \in \Z \ n^2 = 2q$. Note that $q$ here is a dummy variable used to
express the statement $n^2$ is a doubled integer. We may replace it by any
other letter not already in use, for example $\exists p \in \Z \ n^2 = 2p$.
Hence, if we present $p$ such that $n^2 = 2p$, we finish the proof. As a result,
we can complete the proof as follows.
\begin{center}
    Therefore, $n^2 = (2q)^2 = 4q^2$ and so, since $2q^2$ is an integer $n^2$ is
    even.
\end{center}

\subsection{Disproving Statements Involving Quantifiers}
Disproving something seems a bit off from the first glance, but to some extent
it is the same as proving the negation.

\paragraph{Disproving statements of the form $\forall a \in A \ P(a)$.}
We may note that the negation of such a statement is the statement $\exists a
\in A \ \lnot P(a)$. So we can disprove it by giving a single example for which
it is false. This is called \emph{disproof by counterexample} to $P(a)$.

For example, we may disprove the statement $\forall x \in \R \ x^2 > 2$ by
giving a counterexample $x = 1$ since $1^2 = 1 < 2$.

\paragraph{Disproving statements of the form $\exists a \in A \ P(a)$.}
The negation of this statement is the statement $\forall a \in A \ \lnot P(a)$.
Which gives one way of disproving the statement.

Let us prove that there does not exist a real number $x$ such that $x^2 = -1$.
We know that, for all $x \in \R$, we have the inequality $x^2 \ge 0$ and so $x^2
\neq -1$. Hence, there does not exist $x \in \R$ such that $x^2 = -1$.

\section{Cartesian product}
Another ingredient is the notion of Cartesian product. If $X$ and $Y$ are two
sets, then $X \times Y = \set[x \in X \text{ and } y \in Y]{(x, y)}$. We also
denote $\underbrace{X \times X \times \dots \times X}_{k \text{ times}}$ by
$X^k$.

Consider the following example. If $X = \set{a, b, c}$ and $Y = \set{a, b}$,
then
\[
    X \times Y = \set{(a, a), (a, b), (b, a), (b, b), (c, a), (c, b)}.
\]
Additionally, $\R^2 = \R \times \R$ is the familiar $2$-dimensional Euclidean
plane.
\nomenclature[S]{$A \times B$}{denotes the set of all ordered pairs of elements
of $A$ and $B$}

\begin{exercise}
    Find the set $\set{a, b} \times \set{a, b} \setminus
        \set[x \in \set{a, b}]{(x, x)}$
\end{exercise}

\begin{theorem}
\label{theorem:cartesian-product-distributivity}
    For all sets $A$, $B$, $C$, and $D$ the following hold:
    \begin{itemize}
        \item $A \times (B \cup C) = (A \times B) \cup (A \times C)$;
        \item $A \times (B \cap C) = (A \times B) \cap (A \times C)$;
        \item $(A \times B) \cup (C \times D) \subseteq
            (A \cup C) \times (B \cup D)$;
        \item $(A \times B) \cap (C \times D) =
            (A \cap C) \times (B \cap D)$.
    \end{itemize}
\end{theorem}
\begin{proof}
    It is easy to prove this statement by the definitions. Let us prove only the
    second equality, the rest is
    Exercise~\ref{exercise:cartesian-product-distributivity}.

    Note that $(x, y) \in A \times (B \cap C)$ iff $x \in A$ and
    $y \in (B \cap C)$.
    Hence, $(x, y) \in A \times (B \cap C)$ iff $x \in A$, $y \in B$, and
    $y \in C$. Thus $(x, y) \in A \times (B \cap C)$ iff
    $(x, y) \in (A \times B)$ and $(x, y) \in (A \times C)$. As a result,
    $(x, y) \in A \times (B \cap C)$ iff
    $(x, y) \in (A \times B) \cap (A \times C)$ as required.
\end{proof}


\begin{exercise}
\label{exercise:cartesian-product-distributivity}
    Prove the rest of the equalities in
    Theorem~\ref{theorem:cartesian-product-distributivity}.
\end{exercise}


\section{Graphs of Functions}
\label{section:graph}
Now we have all the components to define a function. Mathematicians think about
the functions in the way we defined them at the beginning of the chapter,
however formally in order to define a function $f : X \to Y$ one need to define
a set $D \subseteq X \times Y$ (such a set is called the \emph{graph of the
function} $f$) such that
\begin{itemize}
    \item $\forall x \in X~\exists y \in Y\ (x, y) \in D$ and
    \item $\forall x \in X, y_1, y_2 \in Y\
        ((x, y_1) \in D \land (x, y_2) \in D \implies y_1 = y_2)$.
\end{itemize}
We say that $y \in Y$ is the value $f(x)$ of the function described by $D$ at
$x \in X$ iff $(x, y) \in D$.

The simplest way to think about the functions is in the terms of tables.
Let us use this idea to list all the functions $\set{a, b, c}$ to $\set{d, e}$.
\begin{center}
    \begin{tabular}{l l l l l l l l l}
        \toprule
        $x$ & $f_1(x)$ & $f_2(x)$ & $f_3(x)$ & $f_4(x)$ &
        $f_5(x)$ & $f_6(x)$ & $f_7(x)$ & $f_8(x)$ \\
        \midrule
        a & d & d & d & d & e & e & e & e \\
        b & d & d & e & e & d & d & e & e \\
        c & d & e & d & e & d & e & d & e \\
        \bottomrule
    \end{tabular}
\end{center}

\begin{exercise}
    List all the functions from $\set{a, b}$ to $\set{a, b}$.
\end{exercise}

However, listing all the values of a function is only possible when the domain
of the function is finite. Thus the most common way to describe a function is
using a formula which provides a way to find the value of a function. When the
function is defined as a formula it is important to be clear which sets are the
domain and the codomain of the function.

Let $\R_+ = \set[x \ge 0]{x \in \R}$. Consider the following functions.
\begin{itemize}
    \item $g_1 : \R \to \R$ such that $g_1(x) = x^2$;
    \item $g_2 : \R_+ \to \R$ such that $g_2(x) = x^2$;
    \item $g_3 : \R \to \R_+$ such that $g_3(x) = x^2$;
    \item $g_4 : \R_+ \to \R_+$ such that $g_4(x) = x^2$;
\end{itemize}
Nonetheless that all these functions are defined using the same formula $x^2$,
we will see in the next chapters that these four functions have different
properties.

\begin{exercise}
    Find the graph of the function $f : \Z \to \Z$ such that $f(x) = 3x$.
\end{exercise}

Note that when you define the function you need to define it such that the
definition makes sense for all the elements of the domain. For example, the
formula $g(x) = \frac{x^2 - 3x + 2}{x - 1}$ does not define a function from
$\R$ to $\R$ since it is not defined for $x = 1$. It is typical to define a
function from real numbers to real numbers by a formula and the convention is
that the domain is the set of all numbers for which the formula makes sense
(unless the domain is specified explicitly).
Using this convention the formula $g$ defines a function from $\R \setminus
\set{1}$ to $\R$.

If we really need a function from $\R$ there are two possible approaches for
extending $g$.

\paragraph{Rewriting the formula.}
We can rewrite the formula such that it makes sense for all the real numbers.
Note that for all $x \in \R \setminus \set{1}$,
\[
    \frac{x^2 - 3x + 2}{x - 1} = \frac{(x - 2)(x - 1)}{x - 1} = x - 2.
\]
Then $g_1(x) = x - 2$ defines a function on $\R$ extending the function $g$.

\paragraph{Explicit definition.} Alternatively we can explicitly specify the
value of $g$ at $1$. So
\[
    g_2(x) =
    \begin{cases}
        \frac{x^2 - 3x + 2}{x - 1} & \text{if } x \neq 1 \\
        -1 & \text{if } x = 1
    \end{cases}
\]
defines a function from $\R$ to $\R$. Note that we can specify the values at
individual points any way we want.

Similarly to sets we may define the equality between functions. We say that two
functions $f, g : X \to Y$ are equal ($f = g$) iff $f(x) = g(x)$ for all
$x \in X$ i.e. their graphs are equal. Note that two functions are equal only
if they have the same domains and codomains. For example, $g_1$ and $g_2$ we
just defined are equal to each other nonetheless that we defined them in two
different ways.

We defined $g_1$ and $g_2$ to extend $g$ to a bigger domain, similarly we can
make a domain smaller.
\begin{definition}
    Let $f : X \to Y$ and $A \subseteq X$. Then $f|_{A} : A \to Y$ is a function
    such that $\forall x \in A\ f|_{A}(x) = f(x)$ (we say that $f|_A$ is the
    restriction of $f$ to the set $A$).
\end{definition}

\nomenclature[F]{$f\big\rvert_A$}{denotes the restriction of $f$ to the set $A$}

\section{Composition of Functions}
\begin{figure}
    \begin{center}
        \begin{tikzpicture}[
            >=stealth,
            bullet/.style={
                fill=black,
                circle,
                minimum width=1pt,
                inner sep=1pt
            },
            projection/.style={
                ->,
                thick,
                shorten <=2pt,
                shorten >=2pt
            },
            every fit/.style={
                ellipse,
                draw,
                inner sep=0pt
                }
        ]
            \node at (2,4.7) {$f$};
            \draw[projection] (1,4.5) -- (3,4.5);
            \node at (0,5) {$X$};
            \node[bullet,label=below:$x$] (START)   at (0,2.5){};
            \node at (4,5) {$Y$};
            \node[bullet,label=below:$f(x)$] at (4,2.5){};
            \node at (6,4.7) {$g$};
            \draw[projection] (5,4.5) -- (7,4.5);
            \node at (8,5) {$Z$};
            \node[bullet,label=below:$g\big(f(x)\big)$] (END) at (8,2.5){};

            \draw [line width=8pt, yellow, shorten <=0.25cm,, shorten >=0.6cm, ->] (START.south) to[out=-50, in=-120, distance=4cm, ] node[black, midway, below, align = center, yshift = -0.25cm] {$g \circ f$} (END);

            \draw (0,2.5) ellipse (1.02cm and 2.2cm);
            \draw (4,2.5) ellipse (1.02cm and 2.2cm);
            \draw (8,2.5) ellipse (1.02cm and 2.2cm);

            \draw[projection] (0.3,2.5) -- (3.7,2.5);
            \draw[projection] (4.3,2.5) -- (7.7,2.5);
        \end{tikzpicture}
        \newline
    \end{center}
    \caption{Composition of functions}
\end{figure}

Suppose $f : X \to Y$ and $g : Y \to Z$ be some function. Then, given an
element $x \in X$, the function $f$ assigns $y = f(x) \in Y$, and the function
$g$ assigns $z = g(y) = g(f(x)) \in Z$. Thus using $f$ and $g$ an element of
$Z$ can be assigned to $x$. This operation defines a function from $X$ to $Z$
and the result of this operation is called the \emph{composition} of $f$ and
$g$.
\nomenclature[F]{$f \circ g$}{denotes the composition of functions $f$ and $g$}

\begin{definition}
    If $f : X \to Y$ and $g : Y \to Z$, then $h = g \circ f$ is a
    function from $X$ to $Z$ such that $g(f(x)) = h(x)$ for all $x \in X$.
\end{definition}

Let us consider an example. Let $f : \R \to \R$ such that $f(x) = x + 1$ and
$g : \R \to \R$ such that $g(x) = x^2$. Then $(g \circ f) : \R \to \R$ and
$(g \circ f)(x) = (x + 1)^2$ for all $x \in \R$. Note that the order of $f$ and
$g$ is important since $(f \circ g)(x) = x^2 + 1$. Thus composition is not
\emph{commutative}.

There are two special type functions.
\begin{itemize}
    \item Let $A \subseteq X$, then $i : A \to X$ such that $i(a) = a$ for all
        $a \in A$ is called the \emph{inclusion} function of $A$ into $X$. Observe
        that $(f \circ i) : A \to Y$ and $(f \circ i) = f|_A$
        for any function $f : X \to Y$.
    \item Another important function is called the \emph{identity} function.
        Let $X$ be some set. Then $I_X : X \to X$ is the identity function on $X$
        iff $I_X(x) = x$.
\end{itemize}
\nomenclature[F]{$I_A$}{denotes the identity function on the set $A$}

\begin{theorem}
    Let $f : X \to Y$, $g : Y \to Z$, and $h : Z \to W$. Then
    \begin{itemize}
        \item $h \circ (g \circ f) = (h \circ g) \circ f$.
        \item $f \circ I_X = f = I_Y \circ f$.
    \end{itemize}
\end{theorem}
\begin{proof}
    These results can be proven simply by evaluating the functions. For example,
    both functions in the first equality assign $h(g(f(x)))$ for any $x \in X$
    and so functions are equal.
\end{proof}
Notice that this theorem states that we may write $f \circ g \circ h$ without
ambiguity.

\section{The Image of a Function}
Given a function $f : X \to Y$, it is not necessary that every element of $Y$
is an image of some $x \in X$. For example, the function $\R \to \R$ defined by
the formula $x^2$ does not have $-1$ as a value.

Thus we may give the following definition.
\begin{definition}
    The image of the function $f$ is defined as follows
    \[
        \Im f = \set[\exists x \in X\ f(x) = y]{y \in Y}
        = \set[x \in X]{f(x)}
    \]
    (in other words it is the projection of the graph $D$ of $f$ on the second
    coordinate: $\Im f = \set[(x, y) \in D]{y}$).
\end{definition}
\nomenclature[F]{$\Im f$}{denotes the image of $f$}

\section{Recursive Definitions}
Sometimes you wish to define objects using objects of the same form like in the
case of inductive definitions but you do not know how to enumerate them using
an integer parameter. Using the notion of function and sets we can define such
objects.


Probably the simplest example of such a definition is the definition of a
binary tree. A binary tree is a sequence of integers and parentheses, e.g.,
$1$, $(1 1)$, $(1 (2 3))$ such that the following constraints are true.
\begin{description}
    \item [(the base case)] An integer is a binary tree.
    \item[(recursion step)] If $T_1$ and $T_2$ are binary trees, then
        $(T_1 T_2)$ is also a binary tree.
\end{description}
We denote the set of binary trees by $\mathfrak{T}$.

Using this definition we may see that $(1 (2 3))$ is indeed a binary tree.
\begin{enumerate}
    \item $2$ and $3$ are binary trees so $(2 3)$ is a binary tree.
    \item $1$ is a binary tree, hence, $(1 (2 3))$ is a binary tree.
\end{enumerate}

In other words, $T$ is a binary tree iff there is a sequence
$T_1$, \dots, $T_m$ such that $T_\ell = T$ and for each $i \in \range{m}$,
$T_i$ is an integer or $T_i = (T_j T_k)$ for $j, k < i$.

Now we are ready to give a more general situation. Assume we are given a set
$U$, $B \subseteq U$, and
$\mathcal{F} = \set{f_1 : U^{\ell_1} \to U, \dots, f_n : U^{\ell_n} \to U}$.
(In our example $U$ was the set of sequences of integers and parentheses,
$B$ was a set of sequences consisting of one integer, and
$\mathcal{F} = \set{f}$, where $f(T_1, T_2) = (T_1 T_2)$.) Then we define the
set $S$ to be the set of all $u \in U$ such that there is a sequence
$u_1$, \dots, $u_m$ satisfying the following constraints: $u_m = u$ and
for each $i \in \range{m}$, $u_i \in B$ or $u_i = f(u_{k_1}, \dots, u_{k_\ell})$
for $f \in \mathcal{F}$ and $k_1, \dots, k_\ell < i$. We say that the set $S$
is generated by $\mathcal{F}$ from $B$.

Using similar ideas we may define some functions on the objects defined
recursively. For example, we may define size and height of a binary tree.
\begin{description}
    \item [(the base case)] If tree $T$ is just an integer, then the height $h(T)$
        of $T$ is equal to $0$ and the size $s(T)$ of the tree is $1$.
    \item[(recursion step)] If $T_1$ and $T_2$ are binary trees, then the height
        $h\big((T_1 T_2)\big)$ of $(T_1 T_2)$ is equal to $\max(h(T_1), h(T_2)) + 1$
        and the size $s\big((T_1 T_2)\big)$ is equal to $s(T_1) + s(T_2)$.
\end{description}

However, before we explain how to formalize such a definition, we need to note
that in the general case such definition may be contradictory. Consider
$U = \R$, $B = \set{0}$, and $\mathcal{F} = \set{f, g}$, where $f(x, y) = xy$
and $g(x) = x + 1$. We define $v : U \to \R$ as follows.
\begin{description}
    \item [(the base case)] $v(0) = 0$.
    \item[(recursion step)] $v(f(x, y)) = f(v(x), v(y))$ and $v(g(x)) = v(x) + 1$.
\end{description}
Note that $v(f(g(0), g(0))) = f(v(g(0)), v(g(0))) = \big(v(g(0))\big)^2 = 4$
and $v(g(0)) = v(0) + 2 = 2$.
However, $g(0) = 1$ and $f(g(0), g(0)) = 1$.

Therefore handle such an issue, we consider $S$ that is \emph{freely} generated
from $B$ by by $\mathcal{F}$; the set $S$ is freely generated
from $B$ by by $\mathcal{F}$ iff it is generated by $\mathcal{F}$ from $B$,
$B \cap \Im f = \emptyset$, and $\Im f \cap \Im g = \emptyset$ for any
$f, g \in \mathcal{F}$.

The following theorem claims existence of functions defined recursively.
\begin{theorem}
\label{theorem:recursion-principle}
    Let $S \subseteq U$ be the set freely generated from $B \subseteq U$ by
    $\mathcal{F} = \set{f_1 : U^{\ell_1} \to U, \dots, f_n : U^{\ell_n} \to U}$.
    In addition, let $F_B : B \to V$ and
    $F_1 : V^{\ell_1} \to V, \dots, F_n : V^{\ell_n} \to V$ be some functions.

    Then there is a function $h : S \to V$ such that
    \begin{description}
        \item [(the base case)] $h(u) = F(u)$ for any $u \in B$.
        \item[(recursion step)] $h(f_i(u_1, \dots, u_{\ell_i})) =
            F_i(h(u_1), \dots, h(u_{\ell_i}))$ for any $i \in \range{n}$ and
            $u_1, \dots, u_{\ell_i} \in S$.
    \end{description}
\end{theorem}

\begin{exercise}
    Prove \Cref{theorem:recursion-principle}.
\end{exercise}


Finally, we may develop an induction technique to use with such kind of
definitions.
\begin{theorem}[The Structural Induction Principle]
\label{theorem:structural-induction}
    Let $S \subseteq U$ be the set freely generated from $B \subseteq U$ by
    $\mathcal{F} = \set{f_1 : U^{\ell_1} \to U, \dots, f_n : U^{\ell_n} \to U}$.

    Assume that $S' \subseteq U$ is a set such that the following constraints
    are true.
    \begin{description}
        \item [(the base case)] $B \subseteq S'$
        \item[(recursion step)] $f_i(u_1, \dots, u_{\ell_i}) \in S'$ for any
            $u_1, \dots, u_{\ell_i} \in S'$ and $i \in \range{n}$.
    \end{description}
    Then $S \subseteq S'$.
\end{theorem}

Let us illustrate the application of this theorem by proving that for any
binary tree $T$, $s(T) \le 2^{h(T)}$.
Consider the set $S'$ of all binary trees $T$ such that $s(T) \le 2^{h(T)}$.
First, note that if $T$ is just an integer, then $s(T) = 1 \le 2^0 = 2^{h(T)}$.
In addition, if $s(T_1) \le 2^{h(T_1)}$ and $s(T_2) \le 2^{h(T_2)}$, then
\begin{multline*}
    s\big( (T_1 T_2) \big) = s(T_1) + s(T_2) \le 2^{h(T_1)} + 2^{h(T_2)} \le \\
    2^{\max(h(T_1), h(T_2)) + 1} = 2^{h\big( (T_1 T_2) \big)}.
\end{multline*}
Therefore, by \Cref{theorem:structural-induction}, $S' = S$. Hence, for any
binary tree $T$, $s(T) \le 2^{h(T)}$.

Now we are ready to prove \Cref{theorem:structural-induction}.
\begin{proof}[Proof of \Cref{theorem:structural-induction}]
    We prove the statement using induction. More precisely, we prove using
    induction by $m$ that if there is a sequence
    $u_1$, \dots, $u_m$ such that
    for each $i \in \range{m}$, $u_i \in B$ or $u_i = f(u_{k_1}, \dots, u_{k_\ell})$
    for $f \in \mathcal{F}$ and $k_1, \dots, k_\ell < i$, then $u_m \in S'$.

    The case when $m = 1$ is clear since in this case $u_1 \in B$ which implies
    that it is in $S'$.

    Let us now prove the induction step. Assume that the statement is true for any
    $k \le m$. Consider a sequence $u_1$, \dots, $u_{m + 1}$ such that
    for each $i \in [m + 1]$,
    $u_i \in B$ or $u_i = f(u_{k_1}, \dots, u_{k_\ell})$
    for $f \in \mathcal{F}$ and $k_1, \dots, k_\ell < i$. Let us consider
    $f \in \mathcal{F}$ and $k_1, \dots, k_\ell < m + 1$ such that
    $u_{m + 1} = f(u_{k_1}, \dots, u_{k_\ell})$. By the induction hypothesis,
    $u_{k_1}, \dots, u_{k_\ell} \in S'$. Therefore, by the properties of $S'$,
    $u_{m + 1} \in S'$.
\end{proof}

\begin{chapterendexercises}
    \exercise Find an image of the function $f : \Z \to \Z$ such that
        $f(x) = 3x$.
    \exercise[recommended] Determine the following sets:
        \begin{itemize}
            \item $\set[\exists n \in \N \ m \le n]{m \in \N}$;
            \item $\set[\forall n \in \N \ m \le n]{m \in \N}$;
            \item $\set[\exists m \in \N \ m \le n]{n \in \N}$;
            \item $\set[\forall m \in \N \ m \le n]{n \in \N}$.
        \end{itemize}
    \exercise Prove or disprove the following statements.
        \begin{itemize}
            \item $\forall m, n \in \N \ m \le n$.
            \item $\exists m, n \in \N \ m \le n$.
            \item $\exists m \in \N \forall n \in \N \ m \le n$.
            \item $\forall m \in \N \exists n \in \N \ m \le n$.
            \item $\exists n \in \N \forall m \in \N \ m \le n$.
            \item $\forall n \in \N \exists m \in \N \ m \le n$.
        \end{itemize}

    \exercise[recommended]
        Using recursive definition we can define an arithmetic formula on the
        variables $x_1$, \dots, $x_n$.
        \begin{description}
            \item [(the base case)] $x_i$ is an arithmetic formula on the variables $x_1$,
                \dots, $x_n$ for all $i$; if $c$ is a real number, then $c$ is also
                an arithmetic formula on the variables $x_1$, \dots, $x_n$.
            \item[recursion step:] If $P$ and $Q$ are arithmetic formulas on the variables
                $x_1$, \dots, $x_n$, then $(P + Q)$ and $P \cdot Q$ are arithmetic formulas
                on the variables $x_1$, \dots, $x_n$.
        \end{description}

        We can also define recursively the value of such a formula.
        Let $v_1$, \dots, $v_n$ be some integers.
        \begin{description}
            \item[(the base cases)] $x_i\big\rvert_{x_1 = v_1, \dots, x_n = v_n} = v_i$; in
                other words, the value of the arithmetic formula $x_i$ is equal to $v_i$
                when $x_1 = v_1$, \dots, $x_n = v_n$; if $c$ is a real number, then
                $c\rvert_{x_1 = v_1, \dots, x_n = v_n} = c$.
            \item[(the recursion steps)] If $P$ and $Q$ are arithmetic formulas on the
            variables $x_1$, \dots, $x_n$, then
            \[
                (P + Q)\big\rvert_{x_1 = v_1, \dots, x_n = v_n} =
                P\big\rvert_{x_1 = v_1, \dots, x_n = v_n} +
                Q\big\rvert_{x_1 = v_1, \dots, x_n = v_n}
            \]
            and
            \[
                (P \cdot Q)\big\rvert_{x_1 = v_1, \dots, x_n = v_n} =
                P\big\rvert_{x_1 = v_1, \dots, x_n = v_n} \cdot
                Q\big\rvert_{x_1 = v_1, \dots, x_n = v_n}.
            \]
        \end{description}

        Prove that for any arithmetic formula $A$ on $x$, there is a polynomial
        $p$ such that $p(v) = A\big\rvert_{x = v}$ for any $v \in \R$.
    \exercise We say that $L$ is a list of powers of $x$ iff
        \begin{itemize}
            \item either $L = x^k$ for some positive integer $k$ or
            \item $L = (x^k, L')$ where $L'$ is a list of powers of $x$ and
                $k$ is a positive integer.
        \end{itemize}

        Let $L$ be a list of powers of $x$. We say that the sum of $L$
        with $x = v$ denoted by $\sum L\big\rvert_{x = v}$
        \begin{itemize}
            \item is equal to $x^k$ whether $L = x^k$ and
            \item is equal to $x^k + \sum L'\big\rvert_{x = v}$ whether
                $L = (x^k, L')$.
        \end{itemize}

        Prove that for any list $L$ of powers of $x$ there is a polynomial such that
        $\sum L\big\rvert_{x = v} = p(v)$ for all real numbers $v$.
    \exercise
        \begin{itemize}
            \item Define arithmetic formulas with division and define their value (make
                sure that you handled divisions by $0$).

            \item Show that for any arithmetic formula with division $A$ on $x$,
                there are polynomials $p$ and $q$ such that $\frac{p(v)}{q(v)} =
                A\big\rvert_{x = v}$ or $A\big\rvert_{x = v}$ is not defined for
                any real value $v$.
        \end{itemize}
\end{chapterendexercises}
