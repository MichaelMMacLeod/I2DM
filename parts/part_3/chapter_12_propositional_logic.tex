\chapter{Propositional Logic}
In the Part~\ref{part:mathematical-reasoning} we studied the most important
mathematical notation and how to prove theorems, we gave several ``formal''
definitions; however, our definition of the proof was not quite formal. It just
allowed us to distinguish between good arguments and bad arguments. It is not
enough if we wish to study proofs which is the core of mathematical logic.

\section{Propositional Formulas}
First, we need to define what precisely we mean by ``mathematical statement''.
In order to do this we define a class of formulas called propositional formulas.
\begin{definition}
  We say that $\phi$ is a propositional formula on the variables $x_1$, \dots,
  $x_n$ if
  \begin{itemize}
    \item either $\phi$ is equal to $x_i$ for some $i \in [n]$,
    \item or $\phi$ is equal to $(\psi_1 \land \psi_2)$ or
      $(\psi_1 \lor \psi_2)$, where $\psi_1$ and $\psi_2$ are propositional
      formulas on $x_1$, \dots $x_n$,
    \item or $\phi$ is equal to $\lnot \psi$, where $\psi$ is a propositional
      formula on $x_1$, \dots $x_n$.
  \end{itemize}
\end{definition}

We can also define the value of a formula.
\begin{definition}
  Let $\phi$ be a propositional formula on the variables $x_1$, \dots, $x_n$
  and $v_1, \dots, v_n \in \set{\text{T}, \text{F}}$.

  We say that the value $\phi\big\rvert_{x_1 = v_1, \dots, x_n = v_n}$ of the
  formula $\phi$ when $v_1$ is substituted as the value of $x_1$, \dots,
  and $v_n$  is substituted as the value of $x_n$ is equal to
  \begin{itemize}
    \item $v_i$ if $\phi$ is equal to $x_i$, and
    \item $\psi_1\big\rvert_{x_1 = v_1, \dots, x_n = v_n} \land
      \psi_2\big\rvert_{x_1 = v_1, \dots, x_n = v_n}$ if
      $\phi$ is equal to $(\psi_1 \land \psi_2)$, and
    \item $\psi_1\big\rvert_{x_1 = v_1, \dots, x_n = v_n} \lor
      \psi_2\big\rvert_{x_1 = v_1, \dots, x_n = v_n}$ if
      $\phi$ is equal to $(\psi_1 \lor \psi_2)$, and
    \item $\lnot\psi\big\rvert_{x_1 = v_1, \dots, x_n = v_n}$
      if $\phi$ is equal to $\lnot \psi$.
  \end{itemize}
\end{definition}

For example, the value of a formula $(x_1 \land x_2) \lor x_3$ when T is
substituted as the value of $x_1$, T is substituted as the value of $x_2$,
and F is substituted as the value of $x_3$ is equal to
$(\text{T} \land \text{T}) \lor \text{F} = \text{T}$.

\begin{theorem}
  For any function $f : \set{\text{T}, \text{F}}^n \to
  \set{\text{T}, \text{F}}$ there is a
  formula $\phi$ on the variables $x_1$, \dots, $x_n$ such that
  $\phi\big\rvert_{x_1 = v_1, \dots, x_n = v_n} = f(v_1, \dots, v_n)$ for all
  $v_1, \dots, v_n \in \set{\text{T}, \text{F}}$
\end{theorem}

\section{Truth Tables}
Let us start the discussion of mathematical logic from an example similar to
the proof we gave in the begining of the first chapter. Assume that we know
that if $x$ is a real number such that $x < -2$ or $x > 2$, then $x^2 > 4$. We
can derive that if $\lnot (x^2 > 4)$, then $\lnot (x < -2)$ and $\lnot (x > 2)$.

In order ot emphasize the logical structure of the argument let us denote
$x > 2$ by $p$, $x < -2$ by $q$, and $x^2 > 4$ by $r$. In this case the
argument is as follows. Assume that we know that $(p \lor q) \implies r$. We
can derive that $\lnot r \implies (\lnot p \land \lnot q)$.

How can we check that this argument is correct? The simplest way is to use a
truth table to check that whether the assumption is true, the consequence is
also true.
\begin{center}
  \begin{tabular}{c | c | c | c | c}
    $p$ & $q$ & $r$ & $(p \lor q) \implies r$ &
      $\lnot r \implies (\lnot p \land \lnot q)$ \\
    \hline
    T & T & T & T & T \\
    T & T & F & F & F \\
    T & F & T & T & T \\
    T & F & F & F & F \\
    F & T & T & T & T \\
    F & T & F & F & F \\
    F & F & T & T & T \\
    F & F & F & T & T
  \end{tabular}
\end{center}
It is easy to note that the argument is indeed correct, i.e.
if $(p \lor q) \implies r$ is true, then
$\lnot r \implies (\lnot p \land \lnot q)$ is also true.
This statement says that
\[
  \bigl((p \lor q) \implies r\bigr) \iff
  \bigl(\lnot r \implies (\lnot p \land \lnot q) \bigr)
\]
is always true (we say that this propositional formula is a
\textit{tautology}). A generalization of this saying the if $p \implies q$ is
true, then $\lnot q \implies \lnot p$ is also true is called the
\textit{contraposition} argument.

Let us now consider another argument. If we know that Joe was a good boy and we
know that if Joe is a good boy, then Santa gives a present to Joe. We may
conclude that Santa gives a present to Joe. We can similarly to the previous
example write this argument using variables and connectives.
If we know that $p$ and $p \implies q$, we may conclude that $q$ is true.
\begin{exercise}
  Show that this argument is correct.
\end{exercise}
Such an argument is called \textit{modus ponens}.

\section{Derivation Rules}
The problem of this method is that we need to consider \textbf{all} possible
values of the variables. Let us now consider a more complicated example.
Imagine that we know that $\lnot q$, $p \implies q$. Using the contraposition
argument and modus ponens we may derive $\lnot p$. Indeed, by contraposition
we may conclude that $\lnot q \implies \lnot p$ and modus ponens impies that
$\lnot p$ is true since $\lnot q$ is true.

In other words, we can combine several tautologies to prove another tautology.
Apparently it is enough to fix some small number of tautlogies to derive all
other tautologies, we call these tautlogies ``rules''. There are several ways
to write such proofs, we are going to use Fitch notation for natural deduction.
In this notation any proof is writen in several rows, each row in a Fitch-style
proof is either:
\begin{itemize}
  \item an assumption or subproof assumption.
  \item a sentence justified by the citation of (1) a rule of inference and (2)
    the prior line or lines of the proof that license that rule.
\end{itemize}
We say that there is a natural deduction derivation of $\phi$ from $\psi_1$,
\dots, $\psi_k$. If there is a Fitch-style proof starting with the assumptions
$\psi_1$, \dots, $\psi_k$, and finishes with the formula $\phi$.
Using this scheme we may write the argument we just mentioned as follows.

\noindent $
  \begin{nd}
    \hypo {1} {\lnot q}
    \hypo {2} {p \implies q}
    \have {3} {\lnot q \implies \lnot p} \by{contraposition}{2}
    \have {4} {\lnot p} \by{modus ponens}{1, 3}
  \end{nd}
$

\noindent In the rest of the section we are going to list all the rules we use.

\paragraph{Conjunctions.}
In order to introduce a conjunction we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A}
    \have [n] {3} {B}
    \have [~] {5} {A \land B} \ai{1, 3}
  \end{nd}
\]
This rule corresponds to the tautology $(A \land B) \implies (A \land B)$.

In order to eliminate conjunctions we can use the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {A \land B}
      \have [~] {3} {A} \ae{1}
    \end{nd}$
    &
    $\begin{nd}
      \have [m] {1} {A \land B}
      \have [~] {3} {B} \ae{1}
    \end{nd}$
  \end{tabular}
\end{center}
These rules correspond to the tautologies $(A \land B) \implies A$ and
$(A \land B) \implies B$.

\paragraph{Disjuctions.}
In order to introduce a disjunction we can use the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {A}
      \have [~] {3} {A \lor B} \oi{1}
    \end{nd}$
    &
    $\begin{nd}
      \have [m] {1} {A}
      \have [~] {3} {B \lor A} \oi{1}
    \end{nd}$
  \end{tabular}
\end{center}
These rules correspond to the tautologies $A \implies (A \lor B)$ and
$A \implies (B \lor A)$.

In order to eliminate a disjunction we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A \lor B}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {C}
    \close
    \open
      \hypo [k] {6} {B}
      \have[l] {8} {C}
    \close
    \have[~] {9} {C} \oe{1, 3-5, 6-8}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( (A \lor B) \land (A \implies C) \land (B \implies C) \bigr)
\implies C$.

\paragraph{Implications.}
In order to introduce an implication we can use the following two rules.
\[
  \begin{nd}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {B}
    \close
    \have[~] {9} {A \implies B} \ii{3-5}
  \end{nd}
\]
This rule corresponds to the tautology
$(A \implies B) \implies (A \implies B)$.

In order to eliminate an implication we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A \implies B}
    \have [n] {2} {A}
    \have[~] {9} {B} \ie{1, 2}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( (A \implies B) \land A \bigr)
\implies B$.

\paragraph{Negations.}
In order to introduce a negation we can use the following two rules ($\perp$ is
a special symbol representing a false statement).
\[
  \begin{nd}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {\perp}
    \close
    \have[~] {9} {\lnot A} \ni{3-5}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( A \implies \perp \bigr)
\implies \lnot A$.

In order to eliminate a negation we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A}
    \have [n] {2} {\lnot A}
    \have[~] {9} {\perp} \ne{1, 2}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( A \land \lnot A \bigr)
\implies \perp$.

\paragraph{Truths and falsities.}
Additionally, we have the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {\perp}
      \have [~] {3} {A} \be{1}
    \end{nd}$
    &
    $\begin{nd}
      \open
        \hypo [i] {3} {\lnot A}
        \have[j] {5} {\perp}
      \close
      \have[~] {9} {A} \by{IP}{3, 5}
    \end{nd}$
  \end{tabular}
\end{center}

\begin{marginfigure}
  \begin{center}
    \qrset{link, height=3cm}
    \qrcode{https://proofs.openlogicproject.org/}
    \vskip 0.25cm
    %\href{https://proofs.openlogicproject.org/}{proofs.openlogicproject.org/} \\
    {\footnotesize An online tool to check natural deduction proofs}
  \end{center}
\end{marginfigure}

\begin{exercise}
  Check that all the tautologies we mentioned are indeed tautlogies.
\end{exercise}

\section{Examples of Derivations}
In this section we give several derivations using the rules we just introduced.

First, we prove that if we know that $A \implies \lnot A$ we can derive that
$\lnot A$.

\noindent $
  \begin{nd}
    \hypo {1} {A \implies \lnot A}
    \open
      \hypo {2} {A}
      \have {3} {\lnot A} \ie{1, 2}
      \have {4} {\perp} \ne{2, 3}
    \close
    \have {5} {\lnot A} \ni{2-4}
  \end{nd}
$

Another statement we are going to prove is that if
$A \implies (A \land \lnot A)$ is true, then $\lnot A$ is also true.

\noindent $
  \begin{nd}
    \hypo {1} {A \implies (A \land \lnot A)}
    \open
      \hypo {2} {A}
      \have {3} {A \land \lnot A} \ie{1, 2}
      \have {4} {\lnot A} \ae{3}
      \have {5} {\perp} \ne{2, 4}
    \close
    \have {6} {\lnot A} \ni{2-5}
  \end{nd}
$

A bit more complicated is the proof of the law of excluded middle:
$A \lor \lnot A$.

\noindent $
  \begin{nd}
    \hypo {1} {}
    \open
      \hypo {2} {\lnot (A \lor \lnot A)}
      \open
        \hypo {3} {A}
        \have {4} {A \lor \lnot A} \oi{3}
        \have {5} {\perp} \ne{2, 4}
      \close
      \have {6} {\lnot A} \ni{3-5}
      \have {7} {A \lor \lnot A} \oi{6}
      \have {8} {\perp} \ne{2, 8}
    \close
    \have {9} {A \lor \lnot A} \by{IP}{2-8}
  \end{nd}
$

\section{Soundness and Completeness}
The most important properties of the natural deduction are the following two
theorems.

\begin{theorem}[completeness of natural deductions]
  Let $\phi$ be a propositional formula. If $\phi$ is a tautology, then
  there is a proof of $\phi$.
\end{theorem}

\begin{theorem}[soundness of natural deductions]
  Let $\phi$ be a propositional formula. If there is a proof of $\phi$, then
  $\phi$ is a tautology.
\end{theorem}


Proofs of these two theorems are not that difficult but very technicall. So
prove these statements on examples to at least illustate them.

\paragraph{Completeness of natural deductions.}
Proofs of this statement exploit the following idea: if a propositional formula
is a tautlogy, then we can verify this statement using the truth table. So
the proof simply bruteforce all the values of the variables of a formula and
check that the formula is indeed true.
Consider a tautlogy $(\lnot A \land \lnot B) \implies \lnot (A \lor B)$.
The proof of this tautlogy is as follows.

First we derive $A \lor \lnot A$ and $B \lor \lnot B$, we use these two
formulas to consider casess using the elimination of disjunction.

\noindent$
\begin{nd}
  \hypo {1} {}
  \have {2} {A \lor \lnot A} \by{the law of excluded middle}{}
  \have {3} {B \lor \lnot B} \by{the law of excluded middle}{}
\end{nd}
$


\noindent After that we consider the case when $A$ and $B$ are both true. Note
that the assumption of the implication is false in this case. Thus we just need
to assume $\lnot A \land \lnot B$, derive the contradiction, and derive
$\lnot (A \lor B)$.

\noindent$
\begin{ndresume}
  \open
    \hypo {4} {A}
    \open
      \hypo {5} {B}
      \open
        \hypo {6} {\lnot A \land \lnot B}
        \have {7} {\lnot A} \ae{6}
        \have {8} {\perp} \ne{4, 7}
        \have {9} {\lnot (A \lor B)} \be{8}
      \close
      \have {10} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \ii{6-9}
    \close
\end{ndresume}
$


\noindent After that we consider the case when $A$ is true but and $B$ is
false. In this case the assumption of the implication is also false, thus the
proof is the same as in the previous case.

\noindent$
\begin{ndresume}
    \open
      \hypo {11} {\lnot B}
      \open
        \hypo {12} {\lnot A \land \lnot B}
        \have {13} {\lnot A} \ae{12}
        \have {14} {\perp} \ne{4, 13}
        \have {15} {\lnot (A \lor B)} \be{14}
      \close
      \have {16} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \ii{6-9}
    \close
    \have {17} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \oe{2, 5-10, 11-16}
  \close
\end{ndresume}
$

\noindent The third case is when $A$ is false but and $B$ is
true. In this case the assumption of the implication is false again, thus the
proof is the same as in the previous two cases.

\noindent$
\begin{ndresume}
  \open
    \hypo {18} {\lnot A}
    \open
      \hypo {19} {B}
      \open
        \hypo {20} {\lnot A \land \lnot B}
        \have {21} {\lnot B} \ae{20}
        \have {22} {\perp} \ne{19, 22}
        \have {23} {\lnot (A \lor B)} \be{22}
      \close
      \have {24} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \ii{20-23}
    \close
\end{ndresume}
$

\noindent Finally, we consider the case when $A$ and $B$ are false. In this
case the assumption of the implication is true, and since the formula is a
tautlogy and $\lnot A \land \lnot B$ is true, we know that $\lnot (A \lor B)$
is also true. Assume that $A \lor B$ is true and note that this is impossible.
Thus using introudction of the negation we can prove the statement.

\noindent$
\begin{ndresume}
    \open
      \hypo {25} {\lnot B}
      \open
        \hypo {26} {\lnot A \land \lnot B}
        \open
          \hypo {27} {A \lor B}
          \open
            \hypo {28} {A}
            \have {29} {\perp} \ne{18, 28}
          \close
          \open
            \hypo {30} {B}
            \have {31} {\perp} \ne{25, 30}
          \close
          \have {32} {\perp} \oe{27, 28-29, 30-31}
        \close
        \have {33} {\lnot (A \lor B)} \ne{26-32}
      \close
      \have {39} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \ii{26-33}
    \close
    \have {40} {(\lnot A \land \lnot B) \implies \lnot (A \lor B)} \oe{1, 3-17, 18-39}
  \close
\end{ndresume}
$

\paragraph{Soundness of natural deductions.}
Idea behind the soundness is also simple. We just explain that every line of
the proof represent a tautology, including the last one. We illustrate this on
the exaple of the proof of $A \lor \lnot A$. Recall that the proof of this
tautology is the following.

\noindent $
  \begin{nd}
    \hypo {1} {}
    \open
      \hypo {2} {\lnot (A \lor \lnot A)}
      \open
        \hypo {3} {A}
        \have {4} {A \lor \lnot A}
        \have {5} {\perp}
      \close
      \have {6} {\lnot A}
      \have {7} {A \lor \lnot A}
      \have {8} {\perp}
    \close
    \have {9} {A \lor \lnot A}
  \end{nd}
$

\begin{enumerate}
  \item The second line is just an assumption, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \implies \lnot (A \lor \lnot A)$.
  \item Line~3 is also an assumption so the corresponding tautology is
    $\lnot (A \lor \lnot A) \implies (A \implies A)$.
  \item Line~4 is a formula $A \lor \lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$ and $A$, so the corresponding tautlogy is
    $\lnot (A \lor \lnot A) \implies (A \implies (A \lor \lnot A))$ (it is a
    tautology since we replaced $A$ by $A \lor \lnot A$ in the conclusion of
    the formula corresponding to Line~3).
  \item Line~5 is a formula $\perp$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$ and $A$, so the corresponding tautlogy is
    $\lnot (A \lor \lnot A) \implies (A \implies \perp)$ (it is a
    tautology since on Line~4 we explained that $\lnot (A \lor \lnot A)
    \implies (A \implies (A \lor \lnot A))$).
  \item Line~6 is a formula $\lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautlogy is
    $\lnot (A \lor \lnot A) \implies \lnot A$ (it is a
    tautology since on Line~5 we explained that $A \implies \perp$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Line~7 is a formula $A \lor \lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautlogy is
    $\lnot (A \lor \lnot A) \implies (A \lor \lnot A)$ (it is a
    tautology since on Line~6 we explained that $A$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Line~8 is a formula $\perp$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautlogy is
    $\lnot (A \lor \lnot A) \implies \perp$ (it is a
    tautology since on Line~6 we explained that $A \lor \lnot A$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Finally, Line~9 is a formula $A \lor \lnot A$ (it is a tautlogy since
    we proved that $\lnot (A \lor \lnot A) \implies \perp$ is a tautlogy)
\end{enumerate}


\section*{End of The Chapter Exercises}
\begin{exercises}
  \exerciseitem Derive $(A \land B) \implies C$ from
    $A \implies (B \implies C)$.
  \exerciseitem Derive $A \lor C$ from
    $(A \land B) \lor C$.
  \exerciseitem Derive $B \lor C$ from
    $A \implies B$ and $\lnot A \implies C$.
\end{exercises}
